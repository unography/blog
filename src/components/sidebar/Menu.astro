---
interface Props {
  menu: Array<{ label: string; path: string }>;
}

const { menu } = Astro.props;
// Normalize path by removing trailing slash for comparison
const currentPath = Astro.url.pathname.replace(/\/$/, '') || '/';

function isActive(itemPath: string): boolean {
  const normalizedItemPath = itemPath.replace(/\/$/, '') || '/';
  if (normalizedItemPath === '/') {
    return currentPath === '/' || currentPath.startsWith('/page/');
  }
  return currentPath === normalizedItemPath || currentPath.startsWith(normalizedItemPath + '/');
}
---

<nav class="menu">
  <ul class="menu__list">
    {menu.map((item) => (
      <li class="menu__item">
        <a
          href={item.path}
          class:list={['menu__link', { 'menu__link--active': isActive(item.path) }]}
        >
          {item.label}
        </a>
      </li>
    ))}
  </ul>
</nav>

<style lang="scss">
  @use '@/styles/variables' as *;

  .menu {
    &__list {
      list-style: none;
      padding: 0;
      margin: 20px 0;
    }

    &__item {
      padding: 0;
      margin-bottom: 10px;
    }

    &__link {
      color: $color-base;
      font-weight: 500;
      border-bottom: 1px solid transparent;

      &:hover, &--active {
        color: $color-primary;
        border-bottom-color: $color-primary;
      }
    }
  }
</style>
